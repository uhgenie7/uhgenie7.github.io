"use strict";(self.webpackChunkgenie_log=self.webpackChunkgenie_log||[]).push([[9085],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>u});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=r.createContext({}),s=function(e){var n=r.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},d=function(e){var n=s(e.components);return r.createElement(p.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},m=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=s(t),u=a,k=m["".concat(p,".").concat(u)]||m[u]||c[u]||o;return t?r.createElement(k,i(i({ref:n},d),{},{components:t})):r.createElement(k,i({ref:n},d))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,i=new Array(o);i[0]=m;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=t[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},7458:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var r=t(7462),a=(t(7294),t(3905));const o={title:"10\uc6d4 \ud504\ub9ac\uc628\ubcf4\ub529 \ud504\ub860\ud2b8\uc5d4\ub4dc \ucc4c\ub9b0\uc9c0 \uc0ac\uc804 \uacfc\uc81c",description:"NextJS\ub97c \ud1ba\uc544\ubcf4\uba70 \uc0ac\uc804 \uacfc\uc81c\ub97c \ud574\uacb0\ud574\ubd05\ub2c8\ub2e4.",tags:["web","next"],date:"2022-09-16"},i=void 0,l={permalink:"/blog/pre-onboarding-frontend-assignment-03",editUrl:"https://github.com/uhgenie7/uhgenie7.github.io/edit/main/blog/pre-onboarding-frontend-assignment-03/index.md",source:"@site/blog/pre-onboarding-frontend-assignment-03/index.md",title:"10\uc6d4 \ud504\ub9ac\uc628\ubcf4\ub529 \ud504\ub860\ud2b8\uc5d4\ub4dc \ucc4c\ub9b0\uc9c0 \uc0ac\uc804 \uacfc\uc81c",description:"NextJS\ub97c \ud1ba\uc544\ubcf4\uba70 \uc0ac\uc804 \uacfc\uc81c\ub97c \ud574\uacb0\ud574\ubd05\ub2c8\ub2e4.",date:"2022-09-16T00:00:00.000Z",formattedDate:"2022\ub144 9\uc6d4 16\uc77c",tags:[{label:"web",permalink:"/blog/tags/web"},{label:"next",permalink:"/blog/tags/next"}],readingTime:10.57,hasTruncateMarker:!0,authors:[],frontMatter:{title:"10\uc6d4 \ud504\ub9ac\uc628\ubcf4\ub529 \ud504\ub860\ud2b8\uc5d4\ub4dc \ucc4c\ub9b0\uc9c0 \uc0ac\uc804 \uacfc\uc81c",description:"NextJS\ub97c \ud1ba\uc544\ubcf4\uba70 \uc0ac\uc804 \uacfc\uc81c\ub97c \ud574\uacb0\ud574\ubd05\ub2c8\ub2e4.",tags:["web","next"],date:"2022-09-16"},prevItem:{title:"10\uc6d4 \ud504\ub9ac\uc628\ubcf4\ub529 \ud504\ub860\ud2b8\uc5d4\ub4dc \ucc4c\ub9b0\uc9c0(1)",permalink:"/blog/pre-onboarding-frontend-03-01"},nextItem:{title:"9\uc6d4 \ud504\ub9ac\uc628\ubcf4\ub529 \ud504\ub860\ud2b8\uc5d4\ub4dc \ucc4c\ub9b0\uc9c0",permalink:"/blog/pre-onboarding-frontend-02"}},p={authorsImageUrls:[]},s=[{value:"1. CSR(Client-side Rendering)\uc774\ub780 \ubb34\uc5c7\uc774\uba70, \uadf8\uac83\uc758 \uc7a5\ub2e8\uc810\uc5d0 \ub300\ud558\uc5ec \uc124\uba85\ud574\uc8fc\uc138\uc694.",id:"1-csrclient-side-rendering\uc774\ub780-\ubb34\uc5c7\uc774\uba70-\uadf8\uac83\uc758-\uc7a5\ub2e8\uc810\uc5d0-\ub300\ud558\uc5ec-\uc124\uba85\ud574\uc8fc\uc138\uc694",level:2},{value:"2. SPA(Single Page Application)\ub85c \uad6c\uc131\ub41c \uc6f9 \uc571\uc5d0\uc11c SSR(Server-side Rendering)\uc774 \ud544\uc694\ud55c \uc774\uc720\uc5d0 \ub300\ud558\uc5ec \uc124\uba85\ud574\uc8fc\uc138\uc694.",id:"2-spasingle-page-application\ub85c-\uad6c\uc131\ub41c-\uc6f9-\uc571\uc5d0\uc11c-ssrserver-side-rendering\uc774-\ud544\uc694\ud55c-\uc774\uc720\uc5d0-\ub300\ud558\uc5ec-\uc124\uba85\ud574\uc8fc\uc138\uc694",level:2},{value:"3. Next.js \ud504\ub85c\uc81d\ud2b8\ub97c \uc138\ud305\ud55c \ub4a4 yarn start \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud588\uc744 \ub54c \uc2e4\ud589\ub418\ub294 \ucf54\ub4dc\ub97c nextjs github \ub808\ud3ec\uc9c0\ud1a0\ub9ac\uc5d0\uc11c \ucc3e\uc740 \ub4a4, \ud574\ub2f9 \ud30c\uc77c\uc5d0 \ub300\ud55c \uac04\ub2e8\ud55c \uc124\uba85\uc744 \ucca8\ubd80\ud574\uc8fc\uc138\uc694.",id:"3-nextjs-\ud504\ub85c\uc81d\ud2b8\ub97c-\uc138\ud305\ud55c-\ub4a4-yarn-start-\uc2a4\ud06c\ub9bd\ud2b8\ub97c-\uc2e4\ud589\ud588\uc744-\ub54c-\uc2e4\ud589\ub418\ub294-\ucf54\ub4dc\ub97c-nextjs-github-\ub808\ud3ec\uc9c0\ud1a0\ub9ac\uc5d0\uc11c-\ucc3e\uc740-\ub4a4-\ud574\ub2f9-\ud30c\uc77c\uc5d0-\ub300\ud55c-\uac04\ub2e8\ud55c-\uc124\uba85\uc744-\ucca8\ubd80\ud574\uc8fc\uc138\uc694",level:2},{value:"yarn start",id:"yarn-start",level:3},{value:"Nextjs repo",id:"nextjs-repo",level:3},{value:"1. cli",id:"1-cli",level:4},{value:"2. server",id:"2-server",level:4},{value:"3. client",id:"3-client",level:4},{value:"\uacfc\uc81c \ud6c4\uae30",id:"\uacfc\uc81c-\ud6c4\uae30",level:2},{value:"Reference",id:"reference",level:2}],d={toc:s};function c(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"10\uc6d4 \ud504\ub9ac\uc628\ubcf4\ub529 \ud504\ub860\ud2b8\uc5d4\ub4dc \ucc4c\ub9b0\uc9c0 \uc0ac\uc804 \uacfc\uc81c\uc785\ub2c8\ub2e4.\n\uc544\ub798 \uae00\uc740 \uc815\ub2f5\uc774 \uc544\ub2c8\uba70, \uc81c \uc0dd\uac01\uc744 \uc801\uc740 \uac83\uc785\ub2c8\ub2e4."),(0,a.kt)("h2",{id:"1-csrclient-side-rendering\uc774\ub780-\ubb34\uc5c7\uc774\uba70-\uadf8\uac83\uc758-\uc7a5\ub2e8\uc810\uc5d0-\ub300\ud558\uc5ec-\uc124\uba85\ud574\uc8fc\uc138\uc694"},"1. CSR(Client-side Rendering)\uc774\ub780 \ubb34\uc5c7\uc774\uba70, \uadf8\uac83\uc758 \uc7a5\ub2e8\uc810\uc5d0 \ub300\ud558\uc5ec \uc124\uba85\ud574\uc8fc\uc138\uc694."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\uc790\ubc14\uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc774\uc6a9\ud558\uc5ec \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c \uc9c1\uc811 \ud398\uc774\uc9c0\ub97c \ub80c\ub354\ub9c1\ud558\ub294 \uac83\uc744 \uc758\ubbf8\ud55c\ub2e4.",(0,a.kt)("table",null,(0,a.kt)("tr",null,(0,a.kt)("th",null,"\uc7a5\uc810"),(0,a.kt)("td",null,"- \uc77c\ub2e8 \ub85c\ub4dc\ub418\uace0 \ub098\uba74 \uc0ac\uc774\ud2b8 \ub0b4\uc5d0\uc11c \ub3cc\uc544\ub2e4\ub2d0 \ub54c \ub85c\ub4dc\ub418\ub294 \uacfc\uc815\uc774 \uc5c6\uc5b4\uc9c0\ubbc0\ub85c \uc0ac\uc6a9\uc131\uc774 \uc88b\uc544\uc9c4\ub2e4."),(0,a.kt)("td",null,"- \uc11c\ubc84\ub97c \ud638\ucd9c\ud560 \ub54c\ub9c8\ub2e4 \uc804\uccb4 UI\ub97c \ub2e4\uc2dc \ub85c\ub4dc\ud560 \ud544\uc694\uac00 \uc5c6\ub2e4.")),(0,a.kt)("tr",null,(0,a.kt)("th",null,"\ub2e8\uc810"),(0,a.kt)("td",null,"\uc560\ud50c\ub9ac\ucf00\uc774\uc158 \uaddc\ubaa8\uac00 \ucee4\uc9c8\uc218\ub85d JS\uc591\uc774 \uc99d\uac00\ud558\uc5ec \ud398\uc774\uc9c0\uac00 \ub2e4\ub978 \uba74\uc5d0\uc11c \ubb34\uac70\uc6cc\uc9c8 \uc218 \uc788\ub2e4."),(0,a.kt)("td",null,"\ucd08\uae30 \ud398\uc774\uc9c0 \ub85c\ub4dc\uc5d0 \ub354 \ub9ce\uc740 \uc2dc\uac04\uc774 \uac78\ub9b0\ub2e4."),(0,a.kt)("td",null,"SEO\uc5d0 \uce5c\ud654\uc801\uc774\uc9c0 \uc54a\ub2e4."))))),(0,a.kt)("h2",{id:"2-spasingle-page-application\ub85c-\uad6c\uc131\ub41c-\uc6f9-\uc571\uc5d0\uc11c-ssrserver-side-rendering\uc774-\ud544\uc694\ud55c-\uc774\uc720\uc5d0-\ub300\ud558\uc5ec-\uc124\uba85\ud574\uc8fc\uc138\uc694"},"2. SPA(Single Page Application)\ub85c \uad6c\uc131\ub41c \uc6f9 \uc571\uc5d0\uc11c SSR(Server-side Rendering)\uc774 \ud544\uc694\ud55c \uc774\uc720\uc5d0 \ub300\ud558\uc5ec \uc124\uba85\ud574\uc8fc\uc138\uc694."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"CSR\uc758 \ub2e8\uc810\uc744 \uadf9\ubcf5\ud558\uba70 SPA\uc758 \uc7a5\uc810\ub3c4 \uac00\uc838\uac08 \uc218 \uc788\ub2e4."),(0,a.kt)("li",{parentName:"ul"},"SSR\uc744 \ud558\ubbc0\ub85c SEO\uc5d0 \uce5c\ud654\uc801\uc774\uc9c0 \uc54a\uc740 CSR\uc758 \ub2e8\uc810\uc744 \uadf9\ubcf5\ud560 \uc218 \uc788\ub2e4."),(0,a.kt)("li",{parentName:"ul"},"\ucd08\uae30 \ud398\uc774\uc9c0 \ub85c\ub4dc\uac00 \ube68\ub77c\uc9c4\ub2e4."),(0,a.kt)("li",{parentName:"ul"},"SPA\ub85c \uad6c\uc131\ub418\uc5b4 \uc788\uc73c\ubbc0\ub85c html\uc744 \uc0c8\ub85c\uace0\uce68\ud558\uc9c0 \uc54a\uc544\ub3c4 \ub41c\ub2e4.")),(0,a.kt)("h2",{id:"3-nextjs-\ud504\ub85c\uc81d\ud2b8\ub97c-\uc138\ud305\ud55c-\ub4a4-yarn-start-\uc2a4\ud06c\ub9bd\ud2b8\ub97c-\uc2e4\ud589\ud588\uc744-\ub54c-\uc2e4\ud589\ub418\ub294-\ucf54\ub4dc\ub97c-nextjs-github-\ub808\ud3ec\uc9c0\ud1a0\ub9ac\uc5d0\uc11c-\ucc3e\uc740-\ub4a4-\ud574\ub2f9-\ud30c\uc77c\uc5d0-\ub300\ud55c-\uac04\ub2e8\ud55c-\uc124\uba85\uc744-\ucca8\ubd80\ud574\uc8fc\uc138\uc694"},"3. Next.js \ud504\ub85c\uc81d\ud2b8\ub97c \uc138\ud305\ud55c \ub4a4 yarn start \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud588\uc744 \ub54c \uc2e4\ud589\ub418\ub294 \ucf54\ub4dc\ub97c nextjs github \ub808\ud3ec\uc9c0\ud1a0\ub9ac\uc5d0\uc11c \ucc3e\uc740 \ub4a4, \ud574\ub2f9 \ud30c\uc77c\uc5d0 \ub300\ud55c \uac04\ub2e8\ud55c \uc124\uba85\uc744 \ucca8\ubd80\ud574\uc8fc\uc138\uc694."),(0,a.kt)("h3",{id:"yarn-start"},"yarn start"),(0,a.kt)("p",null,"Next.js\uac00 Server\uc5d0\uc11c Html\uc744 \ub9cc\ub4e0 \ud6c4, Client\uac00 \ub80c\ub354\ub9c1 \ub41c\ub2e4\ub294 \uac83\uc744 \uc778\uc9c0\ud558\uace0 \ucf54\ub4dc\ub97c \ud655\uc778\ud574\ubcf4\uc558\ub2e4.\nNext.js\ub97c create \ud558\uba74 '","_","app.jsx'\uc744 \ud655\uc778\ud560 \uc218 \uc788\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"import '../styles/globals.css';\nimport type { AppProps } from 'next/app';\n\nfunction MyApp({ Component, pageProps }: AppProps) {\n  return <Component {...pageProps} />;\n}\n\nexport default MyApp;\n")),(0,a.kt)("p",null,"MyApp\uc740 ",(0,a.kt)("inlineCode",{parentName:"p"},"Component"),"\uc640 ",(0,a.kt)("inlineCode",{parentName:"p"},"pageProps"),"\ub97c props\ub85c \ubc1b\ub294\ub2e4."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Component: \uc694\uccad\ud55c \ud398\uc774\uc9c0. ",(0,a.kt)("inlineCode",{parentName:"li"},"/pages/index.jsx")," \ud30c\uc77c\uc774 props\ub85c \ub4e4\uc5b4\uc628\ub2e4. ",(0,a.kt)("inlineCode",{parentName:"li"},"index.jsx"),"\ub97c \uc0ad\uc81c\ud558\uba74 404 Error \ud398\uc774\uc9c0\uac00 \ub72c\ub2e4."),(0,a.kt)("li",{parentName:"ul"},"pageProps: ",(0,a.kt)("inlineCode",{parentName:"li"},"getInitialProps"),"\ub97c \ud1b5\ud574 \ub0b4\ub824 \ubc1b\uc740 props \uc774\ub2e4.")),(0,a.kt)("h3",{id:"nextjs-repo"},"Nextjs repo"),(0,a.kt)("h4",{id:"1-cli"},"1. cli"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/blob/canary/packages/next/cli/next-start.ts"},"packages/next/cli/next-start.ts"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { startServer } from '../server/lib/start-server';\nimport arg from 'next/dist/compiled/arg/index.js';\n\n// next Start\nconst nextStart: cliCommand = (argv) => {\n  const validArgs: arg.Spec = {\n    // Types\n    '--help': Boolean,\n    // ...\n  };\n\n  let args: arg.Result<arg.Spec>;\n\n  try {\n    args = arg(validArgs, { argv });\n    // \uc635\uc158 \uc7ac\ud560\ub2f9\n  } catch (error) {\n    if (isError(error) && error.code === 'ARG_UNKNOWN_OPTION') {\n      return printAndExit(error.message, 1);\n    }\n    throw error;\n  }\n\n  // \uc11c\ubc84\uc5d0\uc11c \uc4f0\uc774\ub294 \ubcc0\uc218\ub4e4\n  const dir = getProjectDir(args._[0]);\n  const host = args['--hostname'] || '0.0.0.0';\n  const port = getPort(args);\n  const keepAliveTimeoutArg: number | undefined = args['--keepAliveTimeout'];\n\n  // ...\n\n  // \uc11c\ubc84 \uc2e4\ud589\n  startServer({\n    // startServer:  https://github.com/vercel/next.js/blob/canary/packages/next/server/lib/start-server.ts\n    dir,\n    hostname: host,\n    port,\n    keepAliveTimeout,\n  })\n    .then(async (app) => {\n      const appUrl = `http://${app.hostname}:${app.port}`;\n      Log.ready(`started server on ${host}:${app.port}, url: ${appUrl}`);\n      await app.prepare(); // app \uad6c\ucd95 \uc900\ube44!\n    })\n    .catch((err) => {\n      console.error(err);\n      process.exit(1);\n    });\n};\n")),(0,a.kt)("p",null,"\uc774\uc81c ",(0,a.kt)("inlineCode",{parentName:"p"},"startServer"),"\uac00 \uc5b4\ub5bb\uac8c \uc11c\ubc84\uad6c\ucd95\uc744 \ud574\uc8fc\uace0 \uc788\ub294\uc9c0 \ucc3e\uc544\ubcf4\uc558\ub2e4."),(0,a.kt)("h4",{id:"2-server"},"2. server"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/blob/canary/packages/next/server/lib/start-server.ts"},"packages/next/server/lib/start-server.ts"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import type { NextServerOptions, NextServer, RequestHandler } from '../next';\nimport next from '../next';\n\nexport function startServer(opts: StartServerOptions) {\n  let requestHandler: RequestHandler;\n\n  const server = http.createServer((req, res) => {\n    return requestHandler(req, res);\n  });\n\n  return new Promise<NextServer>((resolve, reject) => {\n    let port = opts.port;\n    let retryCount = 0;\n    let upgradeHandler: any;\n\n    server.on('listening', () => {\n      const addr = server.address();\n      const hostname =\n        !opts.hostname || opts.hostname === '0.0.0.0'\n          ? 'localhost'\n          : opts.hostname;\n\n      const app = next({\n        // next\uac00 \ubb54\uac00 \ud574\uc8fc\uace0 \uc788\ub294 \uac83\uc744 \ubc1c\uacac\n        ...opts,\n        hostname,\n        customServer: false,\n        httpServer: server,\n        port: addr && typeof addr === 'object' ? addr.port : port,\n      });\n\n      requestHandler = app.getRequestHandler();\n      upgradeHandler = app.getUpgradeHandler();\n      resolve(app);\n    });\n\n    server.listen(port, opts.hostname);\n  });\n}\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"next"),"\uac00 \uc5b4\ub514\uc5d0 \uc788\ub294\uc9c0 \ucc3e\uc544\ubcf4\uc788\ub2e4."),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/blob/canary/packages/next/server/next.ts"},"packages/next/server/next.ts"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"export class NextServer {\n  constructor(options) {\n    this.options = options;\n  }\n\n  get hostname() {\n    return this.options.hostname;\n  }\n  get port() {\n    return this.options.port;\n  }\n\n  getRequestHandler(): RequestHandler {\n    return async (\n      req: IncomingMessage,\n      res: ServerResponse,\n      parsedUrl?: UrlWithParsedQuery\n    ) => {\n      const requestHandler = await this.getServerRequestHandler();\n      return requestHandler(req, res, parsedUrl);\n    };\n  }\n\n  getUpgradeHandler() {\n    return async (req: IncomingMessage, socket: any, head: any) => {\n      const server = await this.getServer();\n      // @ts-expect-error we mark this as protected so it\n      // causes an error here\n      return server.handleUpgrade.apply(server, [req, socket, head]);\n    };\n  }\n\n  // ...\n\n  async prepare() {\n    const server = await this.getServer();\n    return server.prepare();\n  }\n\n  // ...\n\n  async createServer(options) {\n    if (options.dev) {\n      const DevServer = require('./dev/next-dev-server').default;\n      return new DevServer(options);\n    }\n    const ServerImplementation = await getServerImpl();\n    return new ServerImplementation(options);\n  }\n\n  async getServer() {\n    if (!this.serverPromise) {\n      setTimeout(getServerImpl, 10);\n      this.serverPromise = this.loadConfig().then(async (conf) => {\n        this.server = await this.createServer({\n          ...this.options,\n          conf,\n        });\n        if (this.preparedAssetPrefix) {\n          this.server.setAssetPrefix(this.preparedAssetPrefix);\n        }\n        return this.server;\n      });\n    }\n    return this.serverPromise;\n  }\n}\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"nextServer"),"\ub97c \ub9cc\ub4dc\ub294 \uac83(create) \uac19\ub2e4."),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/blob/canary/packages/next/server/next-server.ts"},"packages/next/server/next-server.ts"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { RenderOpts, renderToHTML } from './render';\n\nexport default class NextNodeServer extends BaseServer {\n  // ...\n\n  protected async renderHTML(\n    req: NodeNextRequest,\n    res: NodeNextResponse,\n    pathname: string,\n    query: NextParsedUrlQuery,\n    renderOpts: RenderOpts\n  ): Promise<RenderResult | null> {\n    renderOpts.serverComponentManifest = this.serverComponentManifest;\n    renderOpts.serverCSSManifest = this.serverCSSManifest;\n    renderOpts.fontLoaderManifest = this.fontLoaderManifest;\n\n    return renderToHTML(\n      req.originalRequest,\n      res.originalResponse,\n      pathname,\n      query,\n      renderOpts\n    );\n  }\n}\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/blob/canary/packages/next/server/render.tsx"},"packages/next/server/render.tsx"),"\nrenderToHTML\uc744 \ucc3e\uc544\uc11c \uae4c\ubd24\ub2e4...")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},'export async function renderToHTML() {\n  // ...\n  const AppContainer = ({ children }: { children: JSX.Element }) => (...)\n\n  const AppContainerWithIsomorphicFiberStructure: React.FC<{...}> = ({children}) => {return(...)}\n\n  const Body = ({ children }: { children: JSX.Element }) => {\n    return inAmpMode ? children : <div id="__next">{children}</div>;\n  };\n\n  const renderDocument = async () => {\n    async function loadDocumentInitialProps(\n      renderShell?: (\n        _App: AppType,\n        _Component: NextComponentType\n      ) => Promise<ReactReadableStream>\n    ) {\n      const renderPage: RenderPage = (\n        options: ComponentsEnhancer = {}\n      ): RenderPageResult | Promise<RenderPageResult> => {\n    // ...\n\n        const html = ReactDOMServer.renderToString(\n          <Body>\n            <AppContainerWithIsomorphicFiberStructure>\n              {renderPageTree(EnhancedApp, EnhancedComponent, {\n                ...props,\n                router,\n              })}\n            </AppContainerWithIsomorphicFiberStructure>\n          </Body>\n        );\n\n    // ...\n  }\n\n  const documentResult = await renderDocument();\n\n  const htmlProps: HtmlProps = {...};\n\n  const document = (\n    <AmpStateContext.Provider value={ampState}>\n      <HtmlContext.Provider value={htmlProps}>\n        {documentResult.documentElement(htmlProps)}\n      </HtmlContext.Provider>\n    </AmpStateContext.Provider>\n  );\n\n  const documentHTML = ReactDOMServer.renderToStaticMarkup(document);\n\n  const [renderTargetPrefix, renderTargetSuffix] = documentHTML.split(\n    "<next-js-internal-body-render-target></next-js-internal-body-render-target>"\n  );\n}\n')),(0,a.kt)("h4",{id:"3-client"},"3. client"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/blob/canary/packages/next/client/next.js"},"packages/next/client/next.js"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"import { initialize, hydrate, version, router, emitter } from './';\n\ninitialize({})\n  .then(() => hydrate())\n  .catch(console.error);\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"initialize()"),"\uc774\ud6c4 ",(0,a.kt)("inlineCode",{parentName:"p"},"hydrate()"),"\ub97c \uc2e4\ud589\ud558\uace0 \uc788\ub2e4.",(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("inlineCode",{parentName:"p"},"./")," \uacbd\ub85c\ub97c \ucc3e\uc544\ubcf4\uc558\ub2e4."),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/vercel/next.js/blob/canary/packages/next/client/index.tsx"},"packages/next/client/index.tsx"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"export async function initialize(opts: { webpackHMR?: any } = {}): Promise<{...}> {}\n\nfunction renderApp(App: AppComponent, appProps: AppProps){...}\n\nfunction renderReactElement(){}\n\nfunction doRender(input: RenderRouteInfo): Promise<any> {...}\n\nasync function render(renderingProps: RenderRouteInfo): Promise<void> {...}\n\nexport async function hydrate(opts?: { beforeRender?: () => Promise<void> }) {...}\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"next.js")," \ud30c\uc77c \uc5d0\uc11c \ubcf4\uc558\ub358 ",(0,a.kt)("inlineCode",{parentName:"p"},"initialize")," \ud568\uc218\uc640 ",(0,a.kt)("inlineCode",{parentName:"p"},"hydrate")," \ud568\uc218\uc640 \ub354\ubd88\uc5b4 \ubb34\uc5b8\uac00\ub97c ",(0,a.kt)("inlineCode",{parentName:"p"},"render"),"\ud558\ub294 \uac83 \uac19\uc740 \ud568\uc218\ub97c \uac00\uc838\uc640\ubd24\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'  // next/client/index.jsx\n  export async function initialize(opts: { webpackHMR?: any } = {}): Promise<{\n  assetPrefix: string\n  }> {\n  initialData = JSON.parse(\n  document.getElementById("**NEXT_DATA**")!.textContent!\n  )\n  window.**NEXT_DATA** = initialData\n  }\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"__NEXT_DATA__")," id\ub97c \uac00\uc9c0\uace0 \uc788\ub294 \uc5d8\ub9ac\uba3c\ud2b8\ub97c parse\ud574\uc11c ",(0,a.kt)("inlineCode",{parentName:"p"},"initialData"),"\uc5d0 \ud560\ub2f9\ud558\uace0 \uc788\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'  // next/client/index.jsx\n  export async function initialize(opts: { webpackHMR?: any } = {}): Promise<{\n  assetPrefix: string\n  }> {\n  initialData = JSON.parse(\n  document.getElementById("**NEXT_DATA**")!.textContent!\n  )\n  window.**NEXT_DATA** = initialData\n\n  // With dynamic assetPrefix it\'s no longer possible to set assetPrefix at the build time\n  // So, this is how we do it in the client side at runtime\n  **webpack_public_path** = `${prefix}/_next/` //eslint-disable-line\n  }\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\uc8fc\uc11d\uc774 \ub2ec\ub824\uc788\ub2e4."),(0,a.kt)("li",{parentName:"ul"},"\ub3d9\uc801 assetPrefix\ub97c \uc0ac\uc6a9\ud558\uba74 \ub354 \uc774\uc0c1 \ube4c\ub4dc \uc2dc assetPrefix\ub97c \uc124\uc815\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uc774\uac83\uc774 \ub7f0\ud0c0\uc784\uc5d0 \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21\uc5d0\uc11c \uc218\ud589\ud558\ub294 \ubc29\ubc95\uc785\ub2c8\ub2e4.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"appElement = document.getElementById('__next');\nreturn { assetPrefix: prefix };\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"__next")," id\ub97c \uac00\uc9c0\uace0 \uc788\ub294 \uc5d8\ub9ac\uba3c\ud2b8\ub97c appElement\uc5d0 \ud560\ub2f9\ud55c \uc774\ud6c4, ",(0,a.kt)("inlineCode",{parentName:"p"},"assetPrefix"),"\ub97c \ubc18\ud658\ud55c\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"function renderApp(App: AppComponent, appProps: AppProps) {\n  return <App {...appProps} />;\n}\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"renderApp")," \ud568\uc218\ub294 ",(0,a.kt)("inlineCode",{parentName:"p"},"App"),"\uacfc ",(0,a.kt)("inlineCode",{parentName:"p"},"appProps")," \ub9e4\uac1c\ubcc0\uc218\ub97c \ubc1b\uc544\uc11c ",(0,a.kt)("inlineCode",{parentName:"p"},"AppComponent"),"\ub97c \ub9ac\ud134\ud55c\ub2e4."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'function renderReactElement(\n  domEl: HTMLElement,\n  fn: (cb: () => void) => JSX.Element\n): void {\n  // mark start of hydrate/render\n  if (ST) {\n    performance.mark("beforeRender")\n  }\n\n  const reactEl = fn(shouldHydrate ? markHydrateComplete : markRenderComplete)\n\n  if (process.env.__NEXT_REACT_ROOT) {\n    if (!reactRoot) {\n      // Unlike with createRoot, you don\'t need a separate root.render() call here\n      reactRoot = ReactDOM.hydrateRoot(domEl, reactEl)\n      // TODO: Remove shouldHydrate variable when React 18 is stable as it can depend on `reactRoot` existing\n      shouldHydrate = false\n    } else {\n      const startTransition = (React as any).startTransition\n      startTransition(() => {\n        reactRoot.render(reactEl)\n      })\n    }\n  } else {\n    // The check for `.hydrate` is there to support React alternatives like preact\n    if (shouldHydrate) {\n      ReactDOM.hydrate(reactEl, domEl)\n      shouldHydrate = false\n    } else {\n      ReactDOM.render(reactEl, domEl)\n    }\n  }\n}\n')),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://ko.reactjs.org/docs/react-dom.html#render"},"React18\uc774 \uc548\uc815\ud654")," \ub420 \ub54c\uae4c\uc9c0 ReactElement render \ubc29\uc2dd\uc744 if\ubb38\uc73c\ub85c \ub098\ub204\uace0 \uc788\ub2e4.\n\uc0c1\ud669\uc5d0 \ub530\ub77c\uc11c ",(0,a.kt)("inlineCode",{parentName:"p"},"ReactDOM.hydrateRoot"),"\ud558\uac70\ub098 ",(0,a.kt)("inlineCode",{parentName:"p"},"ReactDOM.hydrate"),"\ud558\uac70\ub098 ",(0,a.kt)("inlineCode",{parentName:"p"},"ReactDOM.render"),"\uc73c\ub85c \ub80c\ub354\ud558\uace0 \uc788\ub2e4.\n",(0,a.kt)("inlineCode",{parentName:"p"},"ReactDOM.hydrateRoot"),"\ubb38\uc744 \ud0d4\ub2e4\uba74, \ubcc4\ub3c4\ub85c ",(0,a.kt)("inlineCode",{parentName:"p"},"root.render()"),"\ud558\uc9c0 \uc54a\uc544\ub3c4 \ub41c\ub2e4.\n",(0,a.kt)("inlineCode",{parentName:"p"},"shouldHydrate"),"\uc758 boolean \uc0c1\ud0dc\uc5d0 \ub530\ub77c ",(0,a.kt)("inlineCode",{parentName:"p"},"reactEl"),"\uc758 fn\uac00 \ub2ec\ub77c\uc9c4\ub2e4 (markHydrateComplete || markRenderComplete)"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("inlineCode",{parentName:"p"},"ReactDOM.render()"),"\ub294 \ub80c\ub354\ub9c1\ud558\uae30 \uc6d0\ud558\ub294 \ucef4\ud3ec\ub10c\ud2b8, \ub80c\ub354\ub9c1 \ub418\uae38 \uc6d0\ud558\ub294 \ucef4\ud3ec\ub10c\ud2b8\ub4e4\uc774 \ud3ec\ud568\ub41c DOM \uc694\uc18c\ub97c \uc778\uc218\ub85c \ubc1b\ub294\ub2e4.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},'function doRender(input: RenderRouteInfo): Promise<any> {\n  let { App, Component, props, err }: RenderRouteInfo = input\n\n  const appProps: AppProps = {\n    ...props,\n    Component,\n    err,\n    router,\n  }\n\n  // ...\ubb54\uac00 <style> \uc744 \ubd99\uc774\uace0 \uc788\ub294 \uac83 \uac19\uc74c...\n\n  const elem: JSX.Element = (\n    <>\n      <Head callback={onHeadCommit} />\n      <AppContainer>\n        {renderApp(App, appProps)}\n        <Portal type="next-route-announcer">\n          <RouteAnnouncer />\n        </Portal>\n      </AppContainer>\n    </>\n  )\n\n  // We catch runtime errors using componentDidCatch which will trigger renderError\n  renderReactElement(appElement!, callback => (\n    <Root callbacks={[callback, onRootCommit]}>\n      {process.env.__NEXT_STRICT_MODE ? (\n        <React.StrictMode>{elem}</React.StrictMode>\n      ) : (\n        elem\n      )}\n    </Root>\n  ))\n\n  return renderPromise\n}\n')),(0,a.kt)("p",null,"\uc704\uc5d0\uc11c \uc798 \ub9cc\ub4e0 \uac83\ub4e4\uc744 ",(0,a.kt)("inlineCode",{parentName:"p"},"doRender")," \ud568\uc218\ub85c \ub80c\ub354\ud55c\ub2e4\uace0 \uc774\ud574\ud588\ub2e4.\n\uc774\ub54c ",(0,a.kt)("inlineCode",{parentName:"p"},"renderReactElement"),"\uac00 \uc7ac\ub4f1\uc7a5\ud558\ub294\ub370, ",(0,a.kt)("inlineCode",{parentName:"p"}," renderReactElement")," \ud568\uc218\uc758 \uccab \ubc88\uc9f8 \ub9e4\uac1c\ubcc0\uc218\ub294 ",(0,a.kt)("inlineCode",{parentName:"p"},"domEl: HTMLElement"),"\uc600\uace0 \ub450 \ubc88\uc9f8 \ub9e4\uac1c\ubcc0\uc218\ub294",(0,a.kt)("inlineCode",{parentName:"p"},"fn: (cb: () => void) => JSX.Element"),"\uc600\ub2e4."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"appElement"),"\ub294 ",(0,a.kt)("inlineCode",{parentName:"li"},"initialize"),"\ud568\uc218\uc5d0\uc11c ",(0,a.kt)("inlineCode",{parentName:"li"},"appElement = document.getElementById('__next')"),"\ub85c \ud560\ub2f9\ud558\uc5c8\ub2e4."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"callback \ud568\uc218"),"\ub294 ",(0,a.kt)("inlineCode",{parentName:"li"},"<Root>")," \ubc11\uc73c\ub85c ",(0,a.kt)("inlineCode",{parentName:"li"},"elem"),"\uc744 \ub123\uc5b4\uc8fc\uace0 \uc788\ub2e4.")),(0,a.kt)("h2",{id:"\uacfc\uc81c-\ud6c4\uae30"},"\uacfc\uc81c \ud6c4\uae30"),(0,a.kt)("p",null,"\ub0b4\uac00 \uacfc\uc81c\ub97c \uc798 \uc774\ud574\ud55c \uac74\uc9c0 \ubaa8\ub974\uaca0\ub2e4. \ub108\ubb34 \uc5b4\ub835\uac8c \uc0dd\uac01\ud55c \uac83 \uac19\uae30\ub3c4 \ud558\uace0... \uc81c\ub300\ub85c \uc774\ud574\ud55c \uac83\uc778\uc9c0 \ud655\uc2e0\ub3c4 \ub4e4\uc9c0 \uc54a\uc558\ub2e4.\n\ucc4c\ub9b0\uc9c0 \uc774\ud6c4 \ubcf4\ub2e4 \ub354 NextJs\ub97c \uc774\ud574\ud560 \uc218 \uc788\uae30\ub97c \ubc14\ub77c\uba70..."),(0,a.kt)("h2",{id:"reference"},"Reference"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://web.dev/rendering-on-the-web/"},"Rendering on the Web"))))}c.isMDXComponent=!0}}]);